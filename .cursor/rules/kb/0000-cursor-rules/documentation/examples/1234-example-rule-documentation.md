# Documentation de la R√®gle Example Rule

## üìã R√©sum√©

La r√®gle `1234-example-rule.mdc` d√©finit les bonnes pratiques pour l'organisation du code JavaScript. Elle √©tablit une m√©thodologie pour garantir la maintenabilit√© et la lisibilit√© du code. Cette r√®gle met l'accent sur la coh√©rence, la modularit√© et les tests.

| Aspect               | Description                                                    |
| -------------------- | -------------------------------------------------------------- |
| **Objectif**         | Standardiser l'organisation et la structure du code JavaScript |
| **Applicabilit√©**    | S'applique √† tous les fichiers `**/*.{js,jsx,ts,tsx}`          |
| **Principe central** | Modularit√© + coh√©rence + testabilit√©                           |
| **Format**           | Modules ES6 avec exports nomm√©s                                |
| **Pr√©requis**        | Comprendre JavaScript ES6+ et les principes SOLID              |

## üß† Concepts Fondamentaux

### Module JavaScript Moderne

Un module JavaScript moderne est une unit√© de code r√©utilisable qui encapsule des fonctionnalit√©s li√©es et expose une interface claire. Les modules facilitent la s√©paration des pr√©occupations, am√©liorent la maintenabilit√© et permettent une meilleure organisation du code.

### Caract√©ristiques d'un Bon Module

Un module bien con√ßu pr√©sente les caract√©ristiques suivantes:

1. **Interface claire** - Exports nomm√©s explicites d√©finissant l'API publique
2. **Responsabilit√© unique** - Se concentre sur une seule pr√©occupation fonctionnelle
3. **Faible couplage** - Minimise les d√©pendances avec les autres modules
4. **Testabilit√©** - Facile √† tester de mani√®re isol√©e
5. **Documentation** - Commentaires JSDoc pour les fonctions export√©es
6. **Taille ma√Ætris√©e** - G√©n√©ralement moins de 300 lignes de code

## üîç Principes de Base JavaScript

La r√®gle d√©finit trois principes fondamentaux pour tout module JavaScript:

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#ebf8f1', 'fontSize': '16px'}}}%%
flowchart TD
    title[<b>Les Trois Principes Fondamentaux</b>]
    style title fill:none,stroke:none

    P1(["Modularit√©"])
    P2(["Coh√©rence"])
    P3(["Testabilit√©"])

    P1 --> P1A["Exports nomm√©s"]
    P1 --> P1B["Responsabilit√© unique"]
    P1 --> P1C["Encapsulation"]

    P2 --> P2A["Conventions de nommage"]
    P2 --> P2B["Structure de fichiers"]
    P2 --> P2C["Style de code"]

    P3 --> P3A["Injection de d√©pendances"]
    P3 --> P3B["Fonctions pures"]
    P3 --> P3C["Interfaces claires"]

    style P1 fill:#d3f0e0,stroke:#2c8560,stroke-width:2px,color:#333
    style P2 fill:#d8e7ff,stroke:#3d6daf,stroke-width:2px,color:#333
    style P3 fill:#ffe7d8,stroke:#af6d3d,stroke-width:2px,color:#333

    style P1A,P1B,P1C fill:#eafaf2,stroke:#2c8560,stroke-width:1px
    style P2A,P2B,P2C fill:#ebf3ff,stroke:#3d6daf,stroke-width:1px
    style P3A,P3B,P3C fill:#fff4eb,stroke:#af6d3d,stroke-width:1px
```

1. **Modularit√©**:

   - Pr√©f√©rer les exports nomm√©s pour une API claire
   - Responsabilit√© unique: chaque module fait une chose bien
   - Encapsulation des d√©tails d'impl√©mentation avec des variables priv√©es

2. **Coh√©rence**:

   - Conventions de nommage uniformes (camelCase, PascalCase)
   - Structure de fichiers coh√©rente dans tout le projet
   - Style de code standardis√© (via ESLint et Prettier)

3. **Testabilit√©**:
   - Injection de d√©pendances pour faciliter les mocks
   - Pr√©f√©rence pour les fonctions pures quand c'est possible
   - Interfaces claires avec des types bien d√©finis

## üîÑ Processus de Refactoring (Œ©‚Ä¢refactor‚Ä¢module)

Le processus `Œ©‚Ä¢refactor‚Ä¢module` d√©finit une approche syst√©matique pour refactoriser un module JavaScript:

```mermaid
flowchart LR
    A["analyze code"] --> B["identify responsibilities"]
    B --> C["separate concerns"]
    C --> D["establish interfaces"]
    D --> E["implement modules"]

    E -- "tests pass" --> F["document API"]
    E -- "tests fail" --> G["revise implementation"]

    style A,B,C,D,E fill:#e6f7ff,stroke:#67c8ff,stroke-width:1px
    style F fill:#d3f0e0,stroke:#2c8560,stroke-width:1px
    style G fill:#ffe7d8,stroke:#af6d3d,stroke-width:1px
```

### √âtapes du Refactoring

1. **Analyse du code**:

   - Compr√©hension de la fonctionnalit√© existante
   - Identification des points de friction et dettes techniques

2. **Identification des responsabilit√©s**:

   - S√©paration des pr√©occupations diff√©rentes
   - Regroupement des fonctionnalit√©s li√©es

3. **S√©paration des pr√©occupations**:

   - Cr√©ation de modules distincts pour chaque responsabilit√©
   - D√©finition des interfaces entre modules

4. **√âtablissement des interfaces**:
   - Conception d'APIs claires pour chaque module
   - D√©finition des contrats et types

## üë®‚Äçüíª Workflow de Test TDD (Œ©‚Ä¢test‚Ä¢module)

Le workflow `Œ©‚Ä¢test‚Ä¢module` d√©finit les √©tapes pour tester un module JavaScript:

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#f0f8ff', 'fontSize': '16px'}}}%%
flowchart TB
    A(["D√©finir les tests"])
    B(["Impl√©menter le code"])
    C(["Refactoriser"])

    A --> B --> C --> A

    A1["Unit tests"]
    A2["Integration tests"]
    A3["Test coverage"]
    A --> A1 & A2 & A3

    B1["Implementation minimale"]
    B2["Satisfy all tests"]
    B3["Handle edge cases"]
    B --> B1 & B2 & B3

    C1["Improve readability"]
    C2["Optimize performance"]
    C3["Maintain interfaces"]
    C --> C1 & C2 & C3

    classDef phase fill:#d6e8d5,stroke:#6c8ea0,stroke-width:2px,color:#333,rx:5
    classDef step fill:#f9f9f9,stroke:#666,stroke-width:1px

    class A,B,C phase
    class A1,A2,A3,B1,B2,B3,C1,C2,C3 step
```

### D√©tail du Workflow TDD

1. **D√©finir les tests**:

   - √âcrire des tests unitaires pour toutes les fonctions export√©es
   - Ajouter des tests d'int√©gration pour les sc√©narios complexes
   - Viser une couverture de tests d'au moins 80%

2. **Impl√©menter le code**:

   - √âcrire l'impl√©mentation minimale pour faire passer les tests
   - S'assurer que tous les tests r√©ussissent
   - G√©rer les cas limites identifi√©s par les tests

3. **Refactoriser**:
   - Am√©liorer la lisibilit√© sans modifier le comportement
   - Optimiser la performance si n√©cessaire
   - Maintenir l'interface publique stable

## üîç Protocole de Validation (Œ©‚Ä¢validate‚Ä¢module)

Le protocole de validation garantit que les modules respectent les standards de qualit√©:

```mermaid
flowchart LR
    A["lint code"] --> B["check structure"]
    B --> C["verify exports"]
    C --> D["run tests"]
    D --> E["review documentation"]

    style A,B,C,D,E fill:#f2dddb,stroke:#a52a2a,stroke-width:1px
```

### √âtapes de Validation

1. **V√©rification du style**:

   - Ex√©cution de ESLint avec la configuration du projet
   - V√©rification du formatage avec Prettier

2. **V√©rification de la structure**:

   - Respect de la structure de fichiers du projet
   - Importations organis√©es et tri√©es

3. **V√©rification des exports**:

   - Interface publique claire et bien d√©finie
   - Pas d'exports par d√©faut sauf exception justifi√©e

4. **Ex√©cution des tests**:

   - Tests unitaires et d'int√©gration qui passent
   - Couverture de code suffisante (>80%)

5. **Revue de la documentation**:
   - Documentation JSDoc pour toutes les fonctions export√©es
   - README mis √† jour si n√©cessaire

## üìã Structure du Projet JavaScript

La r√®gle recommande d'organiser les modules selon les principes de fractionnement fonctionnel:

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#f0f8ff', 'fontSize': '16px'}}}%%
flowchart TD
    title[<b>Organisation Modulaire JavaScript</b>]
    style title fill:none,stroke:none

    L1["Modules Fonctionnels"]
    L2["Modules Utilitaires"]
    L3["Modules Core"]
    L4["Modules UI"]

    L1 --> L2
    L2 --> L3
    L1 --> L4

    subgraph E1 ["Exemples de Modules"]
        FN1["userManagement.js"]
        FN2["paymentProcessing.js"]

        UT1["formatters.js"]
        UT2["validators.js"]

        CR1["api.js"]
        CR2["store.js"]

        UI1["components.js"]
        UI2["hooks.js"]
    end

    L1 -.- FN1 & FN2
    L2 -.- UT1 & UT2
    L3 -.- CR1 & CR2
    L4 -.- UI1 & UI2

    style L1,L2,L3,L4 fill:#d3f0e0,stroke:#2c8560,stroke-width:2px,color:#333,rx:8
    classDef example fill:#f9f9f9,stroke:#999,stroke-width:1px
    class FN1,FN2,UT1,UT2,CR1,CR2,UI1,UI2 example
    class E1 fill:#f9f9f9,stroke:none
```

### Les Quatre Types de Modules

1. **Modules Fonctionnels** (`/src/features/`):

   - Impl√©mentent des fonctionnalit√©s m√©tier sp√©cifiques
   - Peuvent combiner UI, logique et API
   - Exemples: `userManagement.js`, `paymentProcessing.js`

2. **Modules Utilitaires** (`/src/utils/`):

   - Fournissent des fonctions r√©utilisables
   - Ind√©pendants du domaine m√©tier
   - Exemples: `formatters.js`, `validators.js`

3. **Modules Core** (`/src/core/`):

   - Infrastructure fondamentale de l'application
   - Configurent l'environnement et les services globaux
   - Exemples: `api.js`, `store.js`

4. **Modules UI** (`/src/ui/`):
   - Composants d'interface utilisateur r√©utilisables
   - Hooks et logique de pr√©sentation
   - Exemples: `components.js`, `hooks.js`

## ü§ñ D√©l√©gation au LLM

### LLM Code Analyzer pour JavaScript

La r√®gle d√©finit comment le LLM peut assister dans l'analyse du code JavaScript:

```mermaid
flowchart TD
    LLM(["LLM JavaScript Analyzer"]) --> TASKS
    LLM --> INPUTS
    LLM --> OUTPUTS

    subgraph TASKS ["T√¢ches"]
        T1["Analyse de structure"]
        T2["D√©tection de smells"]
        T3["Suggestions de refactoring"]
    end

    subgraph INPUTS ["Entr√©es"]
        I1["Code source"]
        I2["Structure du projet"]
        I3["Exigences"]
    end

    subgraph OUTPUTS ["Sorties"]
        O1["Recommandations d'am√©lioration"]
    end

    style LLM fill:#e3d2ff,stroke:#6a3daf,stroke-width:2px,color:#333,rx:5
    classDef group fill:#f9f9f9,stroke:#666,stroke-width:1px

    class TASKS,INPUTS,OUTPUTS group
    class T1,T2,T3,I1,I2,I3,O1 fill:#f9f9f9,stroke:#999,stroke-width:1px
```

### LLM Test Generator pour JavaScript

La r√®gle d√©finit √©galement comment le LLM peut assister dans la g√©n√©ration de tests:

```mermaid
flowchart TD
    LLM(["LLM Test Generator"]) --> TASKS
    LLM --> INPUTS
    LLM --> OUTPUTS

    subgraph TASKS ["T√¢ches"]
        T1["G√©n√©ration de tests unitaires"]
        T2["Identification de cas limites"]
        T3["G√©n√©ration de mocks"]
    end

    subgraph INPUTS ["Entr√©es"]
        I1["Code source du module"]
        I2["D√©pendances"]
        I3["Sp√©cifications"]
    end

    subgraph OUTPUTS ["Sorties"]
        O1["Tests Jest complets"]
    end

    style LLM fill:#e3d2ff,stroke:#6a3daf,stroke-width:2px,color:#333,rx:5
    classDef group fill:#f9f9f9,stroke:#666,stroke-width:1px

    class TASKS,INPUTS,OUTPUTS group
    class T1,T2,T3,I1,I2,I3,O1 fill:#f9f9f9,stroke:#999,stroke-width:1px
```

## üå≤ Arborescence des Fichiers

### Repr√©sentation Graphique

```mermaid
%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#f0f8ff', 'fontSize': '16px'}}}%%
flowchart TD
    %% Titre du diagramme
    title[<b>Structure de Projet JavaScript</b>]
    style title fill:none,stroke:none

    %% Organisation principale
    ROOT("<b>/</b>") --- SRC["<b>src/</b><br><i>Code source</i>"]

    %% Structure des sous-dossiers et fichiers
    SRC --- FEATURES["<b>features/</b><br><i>Modules fonctionnels</i>"]
    SRC --- UTILS["<b>utils/</b><br><i>Utilitaires</i>"]
    SRC --- CORE["<b>core/</b><br><i>Infrastructure</i>"]
    SRC --- UI["<b>ui/</b><br><i>Composants UI</i>"]

    %% Exemple de fichiers dans features
    subgraph FEAT_FILES [" "]
        FEAT_USER["user/"]
        FEAT_USER --- USER_AUTH["auth.js"]
        FEAT_USER --- USER_PROFILE["profile.js"]

        FEAT_PAY["payment/"]
        FEAT_PAY --- PAY_PROC["processor.js"]
    end
    FEATURES --- FEAT_FILES

    %% Styles
    classDef directory fill:#f9d77e,stroke:#d9b066,stroke-width:2px,border-radius:8px
    classDef file fill:#f9f9f9,stroke:#999,stroke-width:1px,border-radius:4px
    classDef section fill:#e6f7ff,stroke:#67c8ff,stroke-width:1px,stroke-dasharray:5 5,border-radius:10px
    classDef layer fill:#d3f0e0,stroke:#2c8560,stroke-width:2px,color:#333,border-radius:8px

    class ROOT,SRC,FEATURES,UTILS,CORE,UI,FEAT_USER,FEAT_PAY directory
    class USER_AUTH,USER_PROFILE,PAY_PROC file
    class FEAT_FILES section
    class FEATURES,UTILS,CORE,UI layer
```

### Repr√©sentation Textuelle D√©taill√©e

```
/
‚îÇ
‚îú‚îÄ‚îÄ src/                                     # CODE SOURCE
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ features/                            # MODULES FONCTIONNELS - Logique m√©tier
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/                            # Module utilisateur
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js                      # Authentification
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ profile.js                   # Gestion de profil
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payment/                         # Module paiement
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ processor.js                 # Traitement des paiements
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/                               # UTILITAIRES - Fonctions g√©n√©riques
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formatters.js                    # Formatage de donn√©es
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validators.js                    # Validation de donn√©es
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/                                # CORE - Infrastructure fondamentale
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js                           # Client API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ store.js                         # √âtat global
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ ui/                                  # UI - Interface utilisateur
‚îÇ       ‚îÇ
‚îÇ       ‚îú‚îÄ‚îÄ components/                      # Composants r√©utilisables
‚îÇ       ‚îî‚îÄ‚îÄ hooks/                           # Hooks personnalis√©s
‚îÇ
‚îî‚îÄ‚îÄ tests/                                   # TESTS
    ‚îî‚îÄ‚îÄ Structure miroir de /src
```

### Convention de Nommage

- **Fichiers modules**: `camelCase.js` (ex: `userAuth.js`)
- **Classes/Composants**: `PascalCase.js` (ex: `UserProfile.js`)
- **Organisation**: `/src/{type}/{domaine}/`

## ‚ö†Ô∏è Contraintes Critiques √† Respecter

La r√®gle identifie plusieurs contraintes importantes:

1. **Pas d'export par d√©faut**:

   - ‚ùå `export default function doSomething() {...}`
   - ‚úÖ `export function doSomething() {...}`

2. **√âviter les modules monolithiques**:

   - ‚ùå Fichiers de plus de 300 lignes
   - ‚úÖ Modules cibl√©s et focalis√©s

3. **Tout module doit √™tre test√©**:

   - ‚ùå Modules sans tests
   - ‚úÖ Au moins 80% de couverture de tests

4. **√âviter les effets de bord**:

   - ‚ùå Fonctions qui modifient des variables externes
   - ‚úÖ Fonctions pures qui retournent de nouvelles valeurs

5. **Pas de logique dupliqu√©e**:
   - ‚ùå Code copi√©/coll√© entre modules
   - ‚úÖ Factorisation des fonctionnalit√©s communes

## üìù Patterns Recommand√©s

### Organisation de Code

- Un module par fonctionnalit√©
- S√©paration des pr√©occupations UI/logique m√©tier/data
- Structure de dossiers coh√©rente

### Patterns Fonctionnels

- Immutabilit√© des donn√©es
- Composition de fonctions
- Gestion d'erreurs avec Result/Either

### Patterns de Modules

- Exports nomm√©s group√©s en fin de fichier
- Documentation JSDoc compl√®te
- Tests unitaires automatis√©s

## ‚úÖ Liste de V√©rification

Utilisez cette liste pour valider vos modules JavaScript:

- [ ] Le module a une responsabilit√© unique et clairement d√©finie
- [ ] Le module n'utilise que des exports nomm√©s (pas d'export default)
- [ ] Le fichier ne d√©passe pas 300 lignes de code
- [ ] Tous les exports sont document√©s avec JSDoc
- [ ] La couverture de tests est d'au moins 80%
- [ ] Le code respecte les conventions de nommage du projet
- [ ] Le linter ne signale aucune erreur
- [ ] Les d√©pendances sont explicitement d√©clar√©es
- [ ] Pas d'effets de bord non document√©s
- [ ] Le module est plac√© dans la structure de dossiers appropri√©e

## üìö Ressources Additionnelles

Pour plus de d√©tails sur les bonnes pratiques JavaScript, consultez:

- `.cursor/kb/1234-example-rule/guidelines/module_patterns.md` - Patterns de modules
- `.cursor/kb/1234-example-rule/guidelines/testing_strategies.md` - Strat√©gies de test
- `.cursor/kb/1234-example-rule/examples/good_modules.md` - Exemples de bons modules
- `.cursor/kb/1234-example-rule/examples/bad_modules.md` - Anti-patterns √† √©viter
- [MDN - JavaScript Modules](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules)
- [Clean Code JavaScript](https://github.com/ryanmcdermott/clean-code-javascript)
- [You Don't Know JS](https://github.com/getify/You-Dont-Know-JS)
